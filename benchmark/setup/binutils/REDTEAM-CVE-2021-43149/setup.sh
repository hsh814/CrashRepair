#!/bin/bash
BUG_DIR=/data/vulnloc/binutils/REDTEAM-CVE-2021-43149
PROJECT_URL=https://github.com/bminor/binutils-gdb.git
BUG_COMMIT_ID=f356740

mkdir -p ${BUG_DIR}
pushd ${BUG_DIR}

git clone ${PROJECT_URL} src
git checkout ${BUG_COMMIT_ID}

CC=wllvm CXX=wllvm++ ./configure CFLAGS="-DFORTIFY_SOURCE=2 -fstack-protector-all -fno-omit-frame-pointer -ggdb" CXXFLAGS="-DFORTIFY_SOURCE=2 -fstack-protector-all -fno-omit-frame-pointer -ggdb" --disable-shared --disable-gdb --disable-libdecnumber --disable-readline --disable-sim
make -j16
find . -name "config.cache" | xargs rm
