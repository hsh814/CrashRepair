#!/bin/bash
BUG_DIR=/data/vulnloc/jasper/REDTEAM-CVE-2020-27828
PROJECT_URL=https://github.com/jasper-software/jasper.git
BUG_COMMIT_ID=99758566a5fd90d4ff3a8f7827df43b41c49dc05

mkdir -p ${BUG_DIR}
pushd ${BUG_DIR}

git clone ${PROJECT_URL} src
pushd src
git checkout ${BUG_COMMIT_ID}

clang -I src/libjasper/include -E src/libjasper/jpc/jpc_enc.c > src/libjasper/jpc/jpc_enc.c.pre
grep -v '^ *#' src/libjasper/jpc/jpc_enc.c.pre > src/libjasper/jpc/jpc_enc.c